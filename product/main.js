(()=>{"use strict";var e={997:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.database=void 0,t.database=[{format:"simple",data:"956700000400800000300910700021000000000000300790000120000029003000008004000007650",desc:"Diabolic grade from SudokuWiki."},{format:"simple",data:"300750001000300020000009407020001005700000006500900070905100000070003000100068002",desc:"Devious grade from Sudoku+."},{format:"simple",data:"..3.5...7.96..85.....3.2...3....7.6...2...9...8.2....5...9.4.....18..63.4...1.8..",desc:"Devious grade from Sudoku+."},{format:"simple",data:"000008040009040000006203008042009003005000800800400970200307500000090300030800000",desc:"Devious grade from Sudoku+."},{format:"simple",data:"009032000000700000162000000010020560000900000050000107000000403026009000005870000",desc:"Hidden pair example."}]},963:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PuzzleCanvas=t.SVG=void 0;const r=s(466);class n{constructor(e,t){return this.element=document.createElementNS("http://www.w3.org/2000/svg",e),"svg"==e&&this.attr({xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),this.attr(t)}html(e){return this.element.innerHTML=e,this}attr(e={}){for(const t in e)void 0===e[t]||null==e[t]?this.element.removeAttribute(t):this.element.setAttribute(t,e[t]);return this}addTo(e){return e instanceof n&&(e=e.element),e.contains(this.element)||e.appendChild(this.element),this}remove(e){return e instanceof n&&(e=e.element),this.element.contains(e)&&this.element.removeChild(e),this}use(e,t){return new n("use").attr({href:e}).attr(t).addTo(this.element)}g(e){return new n("g").attr(e).addTo(this.element)}defs(e){return new n("defs").attr(e).addTo(this.element)}symbol(e){return new n("symbol").attr(e).addTo(this.element)}rect(e){return new n("rect").attr(e).addTo(this.element)}circle(e){return new n("circle").attr(e).addTo(this.element)}ellipse(e){return new n("ellipse").attr(e).addTo(this.element)}line(e){return new n("line").attr(e).addTo(this.element)}polygon(e){return new n("polygon").attr(e).addTo(this.element)}polyline(e){return new n("polyline").attr(e).addTo(this.element)}path(e){return new n("path").attr(e).addTo(this.element)}text(e,t){return new n("text").html(e).attr(t).addTo(this.element)}}t.SVG=n;class i{constructor(e){this.group=e,this.elements=new Map}get(e){return this.elements.get(e)}set(e,t){this.elements.set(e,t)}show(e){if(this.elements.has(e))return this.elements.get(e).addTo(this.group)}hide(e){if(!this.elements.has(e))return;const t=this.elements.get(e);return this.group.remove(t.element),t}showAll(){return this.elements.map(((e,t)=>t.addTo(this.group))),this}hideAll(){return this.elements.map(((e,t)=>this.group.remove(t))),this}clearStyle(e){const t=e instanceof n?e:this.elements.get(e),s=["fill","stroke","stroke-width"];if(void 0!==t){for(const e of s)t.element.removeAttribute(e);return t}}clearAll(){return this.elements.map(((e,t)=>this.clearStyle(t))),this}}class o extends n{constructor(e={}){super("svg");const t=o.computeStyle(e);this.attr({width:t["canvas-width"],height:t["canvas-height"],viewBox:`0 0 ${t["canvas-width"]} ${t["canvas-height"]}`,"text-anchor":"middle","dominant-baseline":"middle"});const s=t.rows,a=t.columns,l=t.dimension,h=Math.pow(l,2);if(this.rect({id:"bg",width:t["canvas-width"],height:t["canvas-height"]}).attr(t.background),this.headerGroup=this.g({id:"header"}).attr(t["header-font"]),"display"==t.headers){const e=.5*(t["header-size"]+t["grid-padding"]);for(const r of new Array(s).keys()){const s=o.cellCenterXY(0,r,t);this.headerGroup.text(t["header-row-symbols"].charAt(r),{x:e,y:s[1]})}for(const s of new Array(a).keys()){const r=o.cellCenterXY(s,0,t);this.headerGroup.text(t["header-column-symbols"].charAt(s),{x:r[0],y:e})}}const c=t["cell-size"];this.cellRects=new i(this.g({id:"cell_rect",fill:"white"})),this.cellTexts=new i(this.g({id:"cell_text"}).attr(t["cell-font"]));for(const[e,i]of(0,r.multirange)(s,a)){const s=i*a+e,r=o.cellXY(e,i,t);this.cellRects.set(s,new n("rect",{x:r[0],y:r[1],width:c,height:c,rx:4,ry:4})),this.cellTexts.set(s,new n("text",{x:r[0]+.5*c,y:r[1]+.5*c}))}const d=t["mark-size"];this.markRects=new i(this.g({id:"mark_rect"})),this.markTexts=new i(this.g({id:"mark_text"}).attr(t["mark-font"]));for(const[e,i,l]of(0,r.multirange)(a,s,h)){const s=(i*a+e)*h+l,r=o.markXY(e,i,l,t);this.markRects.set(s,new n("rect",{x:r[0],y:r[1],width:d,height:d,rx:4,ry:4})),this.markTexts.set(s,new n("text").html(t["mark-symbols"].charAt(l)).attr({x:r[0]+.5*d,y:r[1]+.5*d}))}this.drawing=this.g({id:"drawing"}),this.cellRects.showAll(),this.style=t}static computeStyle(e={}){if((e=Object.assign(Object.assign({},o.options),e)).rows!=e["header-row-symbols"].length)throw RangeError("The length of the row header does not match the number of rows.");if(e.columns!=e["header-column-symbols"].length)throw RangeError("The length of the column header does not match the number of columns.");if(Math.pow(e.dimension,2)!=e["mark-symbols"].length)throw RangeError("The length of the column header does not match the number of columns.");const t=e.dimension;e["cell-size"]=t*e["mark-size"]+(t-1)*e["cell-inner-sep"]+2*e["cell-padding"],e["box-size"]=t*e["cell-size"]+(t-1)*e["box-inner-sep"]+2*e["box-padding"];const s=[e.columns,e.rows],r=s.map((e=>Math.ceil(e/t))),n=s.map(((t,n)=>s[n]*e["cell-size"]+(s[n]-r[n])*e["box-inner-sep"]+2*r[n]*e["box-padding"]+(r[n]-1)*e["grid-inner-sep"]+2*e["grid-padding"]));return e["grid-width"]=n[0],e["grid-height"]=n[1],e["canvas-width"]=e["grid-width"]+("display"==e.headers?e["header-size"]:0),e["canvas-height"]=e["grid-height"]+("display"==e.headers?e["header-size"]:0),e}static cellXY(e,t,s){if(!("cell-size"in s))throw TypeError("The property 'cell-size' has not been computed yet.");const r=s.dimension,n=[e,t],i=n.map((e=>Math.trunc(e/r)));return n.map(((e,t)=>("display"==s.headers?s["header-size"]:0)+i[t]*s["grid-inner-sep"]+s["grid-padding"]+(n[t]-i[t])*s["box-inner-sep"]+(2*i[t]+1)*s["box-padding"]+n[t]*s["cell-size"]))}static cellCenterXY(e,t,s){if(!("cell-size"in s))throw TypeError("The property 'cell-size' has not been computed yet.");return o.cellXY(e,t,s).map((e=>e+.5*s["cell-size"]))}static markXY(e,t,s,r){if(!("cell-size"in r))throw TypeError("The property 'cell-size' has not been computed yet.");const n=r.dimension,i=[e,t],a=o.cellXY(e,t,r),l=[s%n,Math.trunc(s/n)];return i.map(((e,t)=>a[t]+l[t]*(r["cell-inner-sep"]+r["mark-size"])+r["cell-inner-sep"]))}static markCenterXY(e,t,s,r){return o.markXY(e,t,s,r).map((e=>e+.5*r["mark-size"]))}}t.PuzzleCanvas=o,o.options={rows:9,columns:9,dimension:3,"mark-size":14,"mark-symbols":"123456789","cell-inner-sep":1,"cell-padding":1,"box-inner-sep":1,"box-padding":0,"grid-inner-sep":3,"grid-padding":4,headers:"display","header-size":12,"header-row-symbols":"ABCDEFGHJ","header-column-symbols":"123456789",background:{fill:"black",rx:4,ry:4},"header-font":{"font-family":"Helvetica","font-size":10,fill:"white"},"mark-font":{"font-family":"Helvetica","font-size":9,fill:"black"},"cell-font":{"font-family":"Helvetica","font-size":30,fill:"black"},"rect:removed":{fill:"yellow",stroke:"pink","stroke-width":.75},"rect:determined":{fill:"#6fff83",stroke:"olive","stroke-width":.75},"rect:based":{fill:"#00CED1",stroke:"#2F4F4F","stroke-width":.75},"rect:intersect":{fill:"#73b2ff",stroke:"blue","stroke-width":.75},"rect:affected":{fill:"pink",stroke:"red","stroke-width":.75},"text:removed":{fill:"red"},"text:determined":{fill:"blue"},"text:intersect":{},"text:based":{},"text:affected":{}}},186:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Supergraph=void 0;const r=s(374);class n{constructor(e){this.type="basic",void 0===e?(this.VE=new r.IncidenceMatrix,this.EG=new r.IncidenceMatrix):(this.VE=e.VE.copy(),this.EG=e.EG.copy())}static merge(e,t){if(e.type!==t.type)throw TypeError("The type of the two graphs do not match.");const s=new n;return s.type=e.type,s.VE=r.IncidenceMatrix.union(e.VE,t.VE),s.EG=r.IncidenceMatrix.union(t.EG,t.EG),s}merge(e){if(this.type!==e.type)throw TypeError("The type of the two graphs do not match.");return new n,this.VE=r.IncidenceMatrix.union(this.VE,e.VE),this.EG=r.IncidenceMatrix.union(this.EG,e.EG),this}copy(){return n.merge(this,new n)}filter(e){const t=new n;return t.type=this.type,t.VE=this.VE.filter(((t,s)=>e(t,s,this))),t.EG=this.EG.filter(((e,s)=>t.VE.columns.has(e))),t}"E($v)"(e){return this.VE.rows.get(e)}"V($e)"(e){return this.VE.columns.get(e)}"G($e)"(e){return this.EG.rows.get(e)}"E($g)"(e){return this.EG.columns.get(e)}"V(${e})"(e){return Set.union(...e.map((e=>this["V($e)"](e))))}"V(E($v))"(e){return this["V(${e})"](this["E($v)"](e))}"V(E($v)&E($g))"(e,t){return this["V(${e})"](Set.intersection(this["E($v)"](e),this["E($g)"](t)))}"E(${v})"(e){return Set.union(...e.map((e=>this["E($v)"](e))))}"E(V($e))"(e){return this["E(${v})"](this["V($e)"](e))}"E(V($e))&E($g)"(e,t){return Set.intersection(this["E(V($e))"](e),this["E($g)"](t))}visibleFrom(e,t){const s=void 0===t?this["V(E($v))"](e):this["V(E($v)&E($g))"](e,t);return s.delete(e),s}}t.Supergraph=n},914:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SOGame=void 0;const r=s(466),n=s(361);class i extends n.Supergraph{constructor(e){if(!Number.isInteger(e))throw RangeError("The dimensional parameter must be an integer.");if(e<1)throw RangeError("The dimensional parameter must be at least 1.");if(e>8)throw RangeError("Do you really want to solve such a large puzzle?");super(),this.type="sudoku original",this.Dp=e,this.D1=Math.pow(this.Dp,2),this.D2=Math.pow(this.D1,2),this.D3=Math.pow(this.D1,3),this.adV=new Map,this.adE=new Map;for(const[e,t,s]of(0,r.multirange)(this.D1,this.D1,this.D1)){const n=r.BaseN.fromD([e,t,s],this.D1),i=r.BaseN.toD(n,6,this.Dp),o=r.BaseN.fromD([i[0],i[2]],this.Dp),a=r.BaseN.fromD([i[1],i[3]],this.Dp),l=(this.rc(e,t),r.BaseN.fromD([e,s],this.D1),r.BaseN.fromD([t,s],this.D1),r.BaseN.fromD([o,s],this.D1),r.BaseN.fromD([0,e,t],this.D1)),h=r.BaseN.fromD([1,e,s],this.D1),c=r.BaseN.fromD([2,t,s],this.D1),d=r.BaseN.fromD([3,o,s],this.D1);this.adV.set(n,{row:e,col:t,key:s,box:o,inn:a,rc:l,rk:h,ck:c,bk:d}),this.adE.set(l,{type:"cell",cd1:e,cd2:t}),this.adE.set(h,{type:"row",cd1:e,cd2:s}),this.adE.set(c,{type:"col",cd1:t,cd2:s}),this.adE.set(d,{type:"box",cd1:o,cd2:s}),this.VE.add(n,l),this.VE.add(n,h),this.VE.add(n,c),this.VE.add(n,d),this.EG.add(l,"rc"),this.EG.add(h,"rk"),this.EG.add(c,"ck"),this.EG.add(d,"bk")}}typeE(e){if(0==e)return"cell";if(1==e)return"row";if(2==e)return"col";if(3==e)return"box";throw RangeError("Invalid range of parameter.")}typeEPerp(e){if(1==e)return"col";if(2==e)return"row";if(3==e)return"inn";throw RangeError("Invalid range of parameter.")}rc(e,t){return r.BaseN.fromD([e,t],this.D1)}rk(e,t){return r.BaseN.fromD([e,t],this.D1)}ck(e,t){return r.BaseN.fromD([e,t],this.D1)}bk(e,t){return r.BaseN.fromD([e,t],this.D1)}*loopLineBoxPerKey(e){for(const[t,s,n]of(0,r.multirange)(this.Dp,this.Dp,this.Dp)){const i=r.BaseN.fromD([t,s],this.Dp),o=r.BaseN.fromD([1,i,e],this.D1),a=r.BaseN.fromD([t,n],this.Dp),l=r.BaseN.fromD([3,a,e],this.D1);yield[{type:"row",cd1:i},o,{type:"box",cd1:a},l]}for(const[t,s,n]of(0,r.multirange)(this.Dp,this.Dp,this.Dp)){const i=r.BaseN.fromD([t,s],this.Dp),o=r.BaseN.fromD([2,i,e],this.D1),a=r.BaseN.fromD([n,t],this.Dp),l=r.BaseN.fromD([3,a,e],this.D1);yield[{type:"col",cd1:i},o,{type:"box",cd1:a},l]}}*loopLineBox(){for(const e of(0,r.range)(this.D1))yield*this.loopLineBoxPerKey(e)}*loopCellUnit(){for(const[e,t]of(0,r.multirange)([1,4],this.D1)){const s=r.BaseN.toD(t,2,this.Dp);yield[new Array(this.D1).fill(0).map(((t,n)=>{const i=r.BaseN.toD(n,2,this.Dp);return 1==e?r.BaseN.fromD([s[0],s[1],i[0],i[1]],this.Dp):2==e?r.BaseN.fromD([i[0],i[1],s[0],s[1]],this.Dp):3==e?r.BaseN.fromD([s[0],i[0],s[1],i[1]],this.Dp):0})),new Array(this.D1).fill(0).map(((s,n)=>r.BaseN.fromD([e,t,n],this.D1))),{type:this.typeE(e),cd1:t,typePerp:this.typeEPerp(e)}]}}projAsSet(e,t,s){return e["V(${e})"](t).map((e=>this.adV.get(e)[s]))}projAsMap(e,t,s){return new Map(t.map((t=>[t,e["V($e)"](t).map((e=>this.adV.get(e)[s]))])))}}t.SOGame=i},374:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IncidenceMatrix=void 0;class s{constructor(){this.rows=new Map,this.columns=new Map}*[Symbol.iterator](){for(const[e,t]of this.rows)for(const s of t)yield[e,s]}has(e,t){return this.rows.has(e)&&this.rows.get(e).has(t)}addRow(e){return this.rows.has(e)||this.rows.set(e,new Set),this}addColumn(e){return this.columns.has(e)||this.columns.set(e,new Set),this}add(e,t){return this.addRow(e),this.addColumn(t),this.rows.get(e).add(t),this.columns.get(t).add(e),this}deleteRow(e){if(this.rows.has(e)){const t=this.rows.get(e);for(const s of t){const t=this.columns.get(s);t.delete(e),0==t.size&&this.columns.delete(s)}return this.rows.delete(e),!0}return!1}deleteColumn(e){if(this.columns.has(e)){const t=this.columns.get(e);for(const s of t){const t=this.rows.get(s);t.delete(e),0==t.size&&this.rows.delete(s)}return this.columns.delete(e),!0}return!1}delete(e,t){return!!this.has(e,t)&&(this.rows.get(e).delete(t),this.columns.get(t).delete(e),!0)}clearEmpty(){return this.rows.clearEmptyKeys(),this.columns.clearEmptyKeys(),this}forEach(e){for(const[t,s]of this)e(t,s,this)}map(e){const t=new s;for(const[s,r]of this)t.add(...e(s,r,this));return t}filter(e){const t=new s;for(const[s,r]of this)e(s,r,this)&&t.add(s,r);return t}transpose(){return this.map(((e,t)=>[t,e]))}copy(){const e=new s;for(const[t,s]of this.rows)e.rows.set(t,new Set(s));for(const[t,s]of this.columns)e.columns.set(t,new Set(s));return e}static union(e,t){const s=e.copy();for(const[e,r]of t.rows)s.rows.has(e)?s.rows.set(e,Set.union(s.rows.get(e),r)):s.rows.set(e,r);for(const[e,r]of t.columns)s.columns.has(e)?s.columns.set(e,Set.union(s.columns.get(e),r)):s.columns.set(e,r);return s}}t.IncidenceMatrix=s},501:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(Map,"merge",{value:function e(t,s){const r=new Map(t);for(const[e,s]of t.entries())r.set(e,s);for(const[t,n]of s.entries())if(r.has(t)){const s=r.get(t);n instanceof Set&&s instanceof Set?r.set(t,Set.union(s,n)):n instanceof Map&&s instanceof Map?r.set(t,e(s,n)):r.set(t,n)}else r.set(t,n);return r},enumerable:!1}),Object.defineProperty(Map.prototype,"filter",{value:function(e){const t=new Map;for(const[s,r]of this)e(s,r,this)&&t.set(s,r);return t},enumerable:!1}),Object.defineProperty(Map.prototype,"map",{value:function(e){const t=new Map;for(const[s,r]of this)t.set(s,e(s,r,this));return t},enumerable:!1}),Object.defineProperty(Map.prototype,"clearEmptyKeys",{value:function(){const e=new Map;for(const[t,s]of this)void 0!==s&&(s instanceof Set&&0==s.size||s instanceof Map&&0==s.size||e.set(t,s));return e},enumerable:!1})},361:function(e,t,s){var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,n)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(570),t),n(s(501),t),n(s(351),t),n(s(374),t),n(s(186),t)},351:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MSet=void 0;class s extends Map{constructor(e){if(super(),e instanceof s)for(const[t,s]of e)this.set(t,s);else if(e)for(const t of e)this.add(t)}get count(){return Array.from(this.values()).reduce(((e,t)=>e+t),0)}aget(e){var t;return null!==(t=this.get(e))&&void 0!==t?t:0}modify(e,t){var s;const r=(null!==(s=this.get(e))&&void 0!==s?s:0)+t;return 0==r?this.delete(e):this.set(e,r),this}add(e){return this.modify(e,1)}remove(e){return this.modify(e,-1)}elements(){return this.keys()}every(e){for(const[t,s]of this)if(!e(t,s,this))return!1;return!0}some(e){for(const[t,s]of this)if(e(t,s,this))return!0;return!1}static geqZero(e){for(const[t,s]of e)if(s<0)return!1;return!0}static geq(e,t){var s,r;for(const[r,n]of e)if(n<(null!==(s=t.get(r))&&void 0!==s?s:0))return!1;for(const[s,n]of t)if(n>(null!==(r=e.get(s))&&void 0!==r?r:0))return!1;return!0}static add(...e){var t;const r=new s;for(const s of e)for(const[e,n]of s)r.set(e,(null!==(t=r.get(e))&&void 0!==t?t:0)+n);for(const[e,t]of r)0==t&&r.delete(e);return r}static subtract(e,t){var r;const n=new s;for(const[t,s]of e)n.set(t,s);for(const[e,s]of t)n.set(e,(null!==(r=n.get(e))&&void 0!==r?r:0)-s);for(const[e,t]of n)0==t&&n.delete(e);return n}pick(e){for(const e of this.keys())return e;return e}}t.MSet=s},570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=function(...e){if(0==e.length)return new Set;if(1==e.length)return new Set(e[0]);if(2==e.length){const[t,s]=e[0].size>e[1].size?e:e.reverse(),r=new Set(t);for(const e of s)r.add(e);return r}return s(s(...e.slice(0,2)),...e.slice(2))},r=function(...e){if(0==e.length)throw RangeError("Set intersection requires at least one set.");if(1==e.length)return new Set(e[0]);if(2==e.length){const[t,s]=e[0].size<e[1].size?e:e.reverse(),r=new Set(t);for(const e of t)s.has(e)||r.delete(e);return r}return r(r(...e.slice(0,2)),...e.slice(2))};Object.defineProperty(Set,"union",{value:s,enumerable:!1}),Object.defineProperty(Set,"intersection",{value:r,enumerable:!1}),Object.defineProperty(Set,"diff",{value:function(e,t){const s=new Set(e);for(const e of t)s.delete(e);return s},enumerable:!1}),Object.defineProperty(Set.prototype,"filter",{value:function(e){const t=new Set;for(const s of this)e(s,this)&&t.add(s);return t},enumerable:!1}),Object.defineProperty(Set.prototype,"map",{value:function(e){const t=new Set;for(const s of this)t.add(e(s,this));return t},enumerable:!1}),Object.defineProperty(Set.prototype,"subsets",{value:function*(e,t,s){if(!(e>this.size||e<0))if(0!=e)if(e!=this.size){s=null!=s?s:[...this.values()];for(let r=0;r<s.length;r++){const n=new Set(t).add(s[r]);1==e?yield n:yield*this.subsets(e-1,n,s.slice(r+1))}}else yield new Set(this);else yield new Set},enumerable:!1})},798:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SOSolver=void 0;const r=s(787),n=s(963),i=s(466);class o extends r.Originator{constructor(e,t){super(),this.game=e,this.canvas=new n.PuzzleCanvas(t),this.snapshot={vertices:new Set,clues:new Set,determined:new Set,pencilmarked:new Set,annotations:[]},this.selected=-1}load(e){this.snapshot=e.snapshot,this.selected=e.selected;for(const t of e.logs)console.log(t);this.render()}render(){var e,t,s,r,n,o,a,l,h,c,d;const u=this.snapshot.vertices,f=this.snapshot.clues,m=this.snapshot.determined,p=this.snapshot.pencilmarked,g=this.snapshot.annotations,y=this.game.filter(((e,t)=>u.has(e))),v=this.canvas.style;this.canvas.cellRects.clearAll(),this.canvas.cellTexts.hideAll().clearAll(),this.canvas.markRects.hideAll().clearAll(),this.canvas.markTexts.hideAll().clearAll(),this.canvas.drawing.html("");for(const e of y.EG.columns.get("rc")){const t=y.VE.columns.get(e);1==t.size?t.forEach((t=>{f.has(t)?this.canvas.cellTexts.show(e).html(`${v["mark-symbols"].charAt(t%9)}`).attr({fill:"blue"}):m.has(t)?this.canvas.cellTexts.show(e).html(`${v["mark-symbols"].charAt(t%9)}`):this.canvas.markTexts.show(t)})):0==t.size?this.canvas.cellTexts.show(e).html("X").attr({fill:"red"}):p.has(e)&&t.forEach((e=>{this.canvas.markTexts.show(e)}))}for(const u of g){const f=u.match(/^highlight (\S+) (\d+) as (.*)$/);if(f){const u=f[1],m=Number.parseInt(f[2]),p=f[3];if("mark"==u){if(null===(e=this.canvas.markRects.show(m))||void 0===e||e.attr(v[`rect:${p}`]),null===(t=this.canvas.markTexts.get(m))||void 0===t||t.attr(v[`text:${p}`]),"removed"==p){const e=this.canvas.markRects.get(m).element,t=e.getAttribute("x"),s=e.getAttribute("y"),r=e.getAttribute("width"),n=e.getAttribute("height");this.canvas.drawing.path({d:`M ${t} ${s} l ${r} ${n} m -${r} 0 l ${r} -${n}`}).attr({stroke:"red"})}}else if("cell"==u||"rc"==u)null===(s=this.canvas.cellRects.show(m))||void 0===s||s.attr(v[`rect:${p}`]),null===(r=this.canvas.cellTexts.get(m))||void 0===r||r.attr(v[`text:${p}`]);else if("row"==u){const e=m;for(const t of(0,i.range)(this.game.D1)){const s=i.BaseN.fromD([e,t],this.game.D1);null===(n=this.canvas.cellRects.show(s))||void 0===n||n.attr(v[`rect:${p}`]),null===(o=this.canvas.cellTexts.get(s))||void 0===o||o.attr(v[`text:${p}`])}}else if("col"==u){const e=m;for(const t of(0,i.range)(this.game.D1)){const s=i.BaseN.fromD([t,e],this.game.D1);null===(a=this.canvas.cellRects.show(s))||void 0===a||a.attr(v[`rect:${p}`]),null===(l=this.canvas.cellTexts.get(s))||void 0===l||l.attr(v[`text:${p}`])}}else if("box"==u){const e=i.BaseN.toD(m,2,this.game.Dp);for(const t of(0,i.multirange)(this.game.Dp,this.game.Dp)){const s=i.BaseN.fromD([e[0],t[0],e[1],t[1]],this.game.Dp);null===(h=this.canvas.cellRects.show(s))||void 0===h||h.attr(v[`rect:${p}`]),null===(c=this.canvas.cellTexts.get(s))||void 0===c||c.attr(v[`text:${p}`])}}else"rk"!=u&&"ck"!=u&&"bk"!=u&&"*k"!=u||null===(d=this.game["V($e)"](m))||void 0===d||d.forEach((e=>{var t,s;const r=Math.trunc(e/this.game.D1);null===(t=this.canvas.cellRects.show(r))||void 0===t||t.attr(v[`rect:${p}`]),null===(s=this.canvas.cellTexts.get(r))||void 0===s||s.attr(v[`text:${p}`])}))}}}obviousCandidateRemoval(e){let t=!1;const s=e,r=new Set(this.snapshot.vertices),n=this.snapshot.determined,i=new Array,o=[{type:"initial",logs:["updated by obvious candidate removal"],snapshot:{pencilmarked:e.EG.columns.get("rc"),annotations:i}},{type:"final",logs:[],snapshot:{vertices:r,annotations:[]}}];for(const e of n)for(const n of s.visibleFrom(e))t=!0,r.delete(n),i.push(`highlight mark ${n} as removed`);return t?o:[]}nakedSingle(e){let t=!1;const s=e,r=new Set(this.snapshot.determined),n=new Array,i=[{type:"initial",logs:["updated by naked single"],snapshot:{determined:r,annotations:n}},{type:"final",logs:[],snapshot:{annotations:[]}}];for(const e of s["E($g)"]("rc")){const i=s["V($e)"](e),o=[...i][0];if(1==i.size&&!r.has(o)){t=!0;const e=Math.trunc(o/this.game.D1);r.add(o),n.push(`highlight cell ${e} as determined`)}}return t?i:[]}hiddenSingle(e){var t,s;const r=e,n=new Set(this.snapshot.vertices),i=new Set(this.snapshot.determined),o=new Array,a=new Array,l=[{type:"initial",logs:["updated by hidden single"],snapshot:{annotations:o}},{type:"middle",logs:[],snapshot:{vertices:n,determined:i,annotations:a}},{type:"final",logs:[],snapshot:{annotations:[]}}];for(const e of["bk","rk","ck"])for(const h of r["E($g)"](e)){const c=r["V($e)"](h);if(c.size>1)continue;const d=[...c][0];if(i.has(d))continue;const u=r.visibleFrom(d,"rc");if(0!=u.size){null===(t=l[0].logs)||void 0===t||t.push(`log "Vertex ${d} is a hidden single in the ${e} containing it."`),o.push(`highlight mark ${d} as determined`),o.push(`highlight ${e} ${h} as based`),o.push(`highlight cell ${Math.trunc(d/this.game.D1)} as intersect`),i.add(d),a.push(`highlight cell ${Math.trunc(d/this.game.D1)} as determined`);for(const e of u)n.delete(e),null===(s=l[1].logs)||void 0===s||s.push(`log "Vertex ${e} is in the same unit as the hidden single, hence is removed."`),o.push(`highlight mark ${e} as removed`);return l}}return[]}intersectionPointing(e){var t,s;const r=e,n=new Set(this.snapshot.vertices),i=new Array,o=[{type:"initial",logs:["updated by intersection (pointing)"],snapshot:{annotations:i}},{type:"final",logs:[],snapshot:{vertices:n,annotations:[]}}];for(const[e,a,l,h]of this.game.loopLineBox()){const c=r["V($e)"](h),d=r["V($e)"](a),u=Set.intersection(c,d);if(!(c.size>u.size)&&d.size!=u.size){null===(t=o[0].logs)||void 0===t||t.push(`log "Vertices ${[...u]} form a pointer in ${e.type} ${e.cd1+1}."`),u.forEach((e=>{i.push(`highlight mark ${e} as determined`)})),i.push(`highlight ${e.type} ${e.cd1} as affected`),i.push(`highlight box ${l.cd1} as based`),Set.intersection(this.game["V($e)"](h),this.game["V($e)"](a)).forEach((e=>{var t;i.push(`highlight cell ${null===(t=this.game.adV.get(e))||void 0===t?void 0:t.rc} as intersect`)}));for(const e of Set.diff(d,u))n.delete(e),null===(s=o[1].logs)||void 0===s||s.push(`log "Vertex ${e} in box ${l.cd1+1} is erased by the pointer."`),i.push(`highlight mark ${e} as removed`);return o}}return[]}intersectionClaiming(e){var t,s;const r=e,n=new Set(this.snapshot.vertices),i=new Array,o=[{type:"initial",logs:["updated by intersection (pointing)"],snapshot:{annotations:i}},{type:"final",logs:[],snapshot:{vertices:n,annotations:[]}}];for(const[e,a,l,h]of this.game.loopLineBox()){const c=r["V($e)"](h),d=r["V($e)"](a),u=Set.intersection(c,d);if(!(d.size>u.size)&&c.size!=u.size){null===(t=o[0].logs)||void 0===t||t.push(`log "Vertices ${[...u]} form a claimer in ${e.type} ${e.cd1+1}."`),u.forEach((e=>{i.push(`highlight mark ${e} as determined`)})),i.push(`highlight box ${l.cd1} as affected`),i.push(`highlight ${e.type} ${e.cd1} as based`),Set.intersection(this.game["V($e)"](h),this.game["V($e)"](a)).forEach((e=>{var t;i.push(`highlight cell ${null===(t=this.game.adV.get(e))||void 0===t?void 0:t.rc} as intersect`)}));for(const e of Set.diff(c,u))n.delete(e),null===(s=o[1].logs)||void 0===s||s.push(`log "Vertex ${e} in box ${l.cd1+1} is erased by the claimer."`),i.push(`highlight mark ${e} as removed`);return o}}return[]}nakedSubsetGenerator(e){if(!Number.isInteger(e)||e<2||e>4)throw RangeError("Invalid range of parameter.");const t=new Map([[2,"pair"],[3,"triple"],[4,"quad"]]).get(e);return s=>{var r,n;const i=s,o=new Set(this.snapshot.vertices),a=new Array,l=[{type:"initial",logs:[`updated by naked ${t}`],snapshot:{annotations:a}},{type:"final",logs:[],snapshot:{vertices:o,annotations:[]}}];for(const[s,h,c]of this.game.loopCellUnit()){const d=s.filter((e=>i["V($e)"](e).size>1)),u=this.game.projAsMap(i,new Set(d),"key");for(const s of new Set(d).subsets(e)){const d=Set.union(...s.map((e=>u.get(e))));if(d.size>e)continue;const f=i["V(${e})"](s),m=i["V(${e})"](d.map((e=>h[e]))),p=Set.diff(m,f);if(0!=p.size){null===(r=l[0].logs)||void 0===r||r.push(`log "Cells ${[...s]} form a naked ${t}."`),f.forEach((e=>{a.push(`highlight mark ${e} as determined`)})),a.push(`highlight ${c.type} ${c.cd1} as affected`),s.forEach((e=>{a.push(`highlight cell ${e} as intersect`)}));for(const e of p)o.delete(e),null===(n=l[1].logs)||void 0===n||n.push(`log "Vertex ${e} is erased."`),a.push(`highlight mark ${e} as removed`);return l}}}return[]}}hiddenSubsetGenerator(e){if(!Number.isInteger(e)||e<2||e>4)throw RangeError("Invalid range of parameter.");const t=new Map([[2,"pair"],[3,"triple"],[4,"quad"]]).get(e);return s=>{var r,n;const i=s,o=new Set(this.snapshot.vertices),a=new Array,l=[{type:"initial",logs:[`updated by hidden ${t}`],snapshot:{annotations:a}},{type:"final",logs:[],snapshot:{vertices:o,annotations:[]}}];for(const[s,h,c]of this.game.loopCellUnit()){const d=h.filter((e=>i["V($e)"](e).size>1)),u=c.typePerp,f=this.game.projAsMap(i,new Set(d),u);for(const h of new Set(d).subsets(e)){const d=Set.union(...h.map((e=>f.get(e))));if(d.size>e)continue;const u=d.map((e=>s[e])),m=i["V(${e})"](h),p=i["V(${e})"](u),g=Set.diff(p,m);if(0!=g.size){null===(r=l[0].logs)||void 0===r||r.push(`log "Cells ${[...u]} form a hidden ${t}."`),m.forEach((e=>{a.push(`highlight mark ${e} as determined`)})),a.push(`highlight ${c.type} ${c.cd1} as based`),u.forEach((e=>{a.push(`highlight cell ${e} as intersect`)}));for(const e of g)o.delete(e),null===(n=l[1].logs)||void 0===n||n.push(`log "Vertex ${e} is erased."`),a.push(`highlight mark ${e} as removed`);return l}}}return[]}}}t.SOSolver=o},929:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uint8_to_b64=t.b64_to_uint8=void 0;const s=[...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>65+t))),...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>97+t))),...String.fromCharCode(...new Array(10).fill(0).map(((e,t)=>48+t))),"+","/"],r=new Map(s.map(((e,t)=>[e,t])));r.set("=",0);const n=/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/;t.uint8_to_b64=e=>{var t,r;const n=Math.ceil(e.length/3),i=new Array(4*n);for(let o=0;o<n;o++){const n=e.subarray(3*o,3*(o+1)),a=n[0],l=null!==(t=n[1])&&void 0!==t?t:0,h=null!==(r=n[2])&&void 0!==r?r:0;i[4*o]=s[a>>2],i[4*o+1]=s[(3&a)<<4|l>>4],i[4*o+2]=s[(15&l)<<2|h>>6],i[4*o+3]=s[63&h]}return e.length%3==1&&(i[i.length-1]="=",i[i.length-2]="="),e.length%3==2&&(i[i.length-1]="="),i.join("")},t.b64_to_uint8=e=>{var t;if(!e.match(n))throw TypeError("The input does not match the base64 format.");const s=Math.trunc(e.length/4),i=(null!==(t=e.match(/={1,2}$/))&&void 0!==t?t:[])[0].length,o=new Uint8Array(3*s-i);for(let t=0;t<s;t++){const s=[...e.substring(4*t,4*(t+1))],[n,i,a,l]=s.map((e=>{var t;return null!==(t=r.get(e))&&void 0!==t?t:0}));o[3*t]=n<<2|i>>4,o[3*t+1]=(15&i)<<4|a>>2,o[3*t+2]=(3&a)<<6|l}return o}},793:(e,t,s)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.PuzzleIO=void 0;const n=s(929);class i{static import(e,t,s="base64"){if("sudoku original"!=e.type)throw TypeError("The game is not a sudoku original.");e.Dp;const r=e.D1,i=e.D2,o=e.D3;if(t.length==i?s="simple":"data:"==t.substring(0,5)&&(s="base64"),"simple"==s){const e=[];for(const[s,n]of Array.from(t).entries()){const t=s*r;if(this.importSymbols.has(n))e.push(t+this.importSymbols.get(n));else for(const s of new Array(r).keys())e.push(t+s)}return new Set(e)}if("base64"==s){const e=(0,n.b64_to_uint8)(t.substring(5)),s=[];for(const[t,r]of e.entries()){let e=8*t;for(let t=0;t<8&&!(e>=o);t++)(r&1<<t)>0&&s.push(e),e++}return new Set(s)}throw TypeError(`'${s}' is not a valid format.`)}static export(e,t,s="base64"){if("sudoku original"!=e.type)throw TypeError("The game is not a sudoku original.");e.Dp;const r=e.D1,i=e.D2,o=e.D3;if("simple"==s){const e=new Array(i).fill("!");for(const s of t){const t=Math.trunc(s/r),n=s%r;"!"==e[t]?e[t]=this.exportSymbols[n]:e[t]="."}return e.join("")}if("base64"==s){const e=new Uint8Array(Math.ceil(o/8));for(const s of e.keys()){let r=0;for(let e=0;e<8;e++){const n=8*s+e;t.has(n)&&(r|=1<<e)}e[s]=r}return`data:${(0,n.uint8_to_b64)(e)}`}throw TypeError(`'${s}' is not a valid format.`)}}t.PuzzleIO=i,r=i,i.exportSymbols=["1","2","3","4","5","6","7","8","9",...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>65+t))),...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>97+t))),"<",">"],i.importSymbols=new Map(r.exportSymbols.map(((e,t)=>[e,t])))},787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Caretaker=t.Memento=t.Originator=void 0,t.Originator=class{};class s{constructor(e="undefined",t){this.type="undefined",this.type=e,this.snapshot={},this.logs=[],this.selected=NaN,void 0!==t&&this.copyFrom(t)}isInitial(){return null!=this.type.match(/initial/)}isFinal(){return null!=this.type.match(/final/)}copyFrom(e){var t,s,r;return this.type=null!==(t=e.type)&&void 0!==t?t:this.type,this.logs=null!==(s=e.logs)&&void 0!==s?s:this.logs,this.selected=e.selected&&NaN!=e.selected?e.selected:this.selected,Object.assign(this.snapshot,null!==(r=e.snapshot)&&void 0!==r?r:{}),this}}t.Memento=s,t.Caretaker=class{constructor(e){this.history=new Array,this.time=-1,this.originator=e}atEnd(){return this.time==this.history.length-1}now(){var e;return null!==(e=this.history[this.time])&&void 0!==e?e:null}last(){var e;return null!==(e=this.history[this.history.length-1])&&void 0!==e?e:null}getLastFinalTime(e){for(let t=e;t>=0;t--)if(this.history[t].isFinal())return t;return-1}init(e){this.history=[],this.history.push(e),this.time=0}addSegment(e){const t=this.getLastFinalTime(this.time);if(-1==t)throw RangeError("Something is wrong; there are no final events up to the specified time.");this.history=this.history.slice(0,t+1);for(const t of e)this.history.push((new s).copyFrom(this.last()).copyFrom(t))}moveTo(e){return!(e>=this.history.length||e<0||(this.time=e,this.originator.load(this.history[this.time]),0))}moveBy(e){return this.moveTo(this.time+e)}}},466:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergiter=t.multirange=t.range=t.Range=t.BaseN=void 0;class s{constructor(e){this.base=e}static fromD(e,t){return e.reduce(((e,s)=>e*t+s),0)}fromDigits(e){return s.fromD(e,this.base)}static toD(e,t,s){const r=Array.from({length:t});for(let n=t-1;n>0;n--)r[n]=e%s,e=Math.trunc(e/s);return r[0]=e,r}toDigits(e,t){return s.toD(e,t,this.base)}}t.BaseN=s;class r{constructor(e,t){if(void 0===t){if(!Number.isInteger(e))throw TypeError("The inputs must be integer.");this.a=0,this.b=e}else{if(!Number.isInteger(e)||!Number.isInteger(t))throw TypeError("The inputs must be integer.");this.a=e,this.b=t}}at(e){return this.a+e}get length(){return this.b-this.a}set length(e){this.b=this.a+e}*keys(){const e=this.b-this.a;for(let t=0;t<e;t++)yield t}*values(){for(let e=this.a;e<this.b;e++)yield e}*[Symbol.iterator](){for(let e=this.a;e<this.b;e++)yield e}*entries(){const e=this.b-this.a;for(let t=0;t<e;t++)yield[t,this.a+t]}map(e){const t=this.b-this.a,s=new Array(t);for(let r=0;r<t;r++)s[r]=e(this.a+r,r);return s}forEach(e){const t=this.b-this.a;new Array(t);for(let s=0;s<t;s++)e(this.a+s,s)}}function*n(e,t=[]){if(0==e.length)return[];const s="number"==typeof e[0]?0:e[0][0],r="number"==typeof e[0]?e[0]:e[0][1];if(1==e.length)for(let e=s;e<r;e++)yield[...t,e];else for(let i=s;i<r;i++)yield*n(e.slice(1),[...t,i])}t.Range=r,t.range=(e,t)=>new r(e,t),t.multirange=(...e)=>n(e),t.mergiter=(...e)=>function*(e,s=[]){if(0!=e.length)if(1==e.length)for(const t of e[0])yield[...s,t];else for(const r of e[0])yield*(0,t.mergiter)(e.slice(1),[...s,r]);else yield[]}(e)}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,s),i.exports}(()=>{const e=s(914),t=s(798),r=s(787),n=s(793),i=s(997);console.log("Sudoku Solver build 007");const o=document.getElementById("logs"),a=document.getElementById("puzzle"),l=new e.SOGame(3),h=new t.SOSolver(l);h.canvas.addTo(a);const c=new r.Caretaker(h);var d;!function(e){var t,s,a,d,u,f;const m=[h.obviousCandidateRemoval,h.nakedSingle,h.hiddenSingle,h.intersectionPointing,h.intersectionClaiming,h.nakedSubsetGenerator(2),h.hiddenSubsetGenerator(2),h.nakedSubsetGenerator(3),h.hiddenSubsetGenerator(3),h.nakedSubsetGenerator(4),h.hiddenSubsetGenerator(4)],p=document.getElementById("samples");for(const[e,s]of i.database.entries()){const r=document.createElement("option");r.value=e.toString(),r.innerText=null!==(t=s.desc)&&void 0!==t?t:`Sample #${e+1}`,r.selected=0==e,p.appendChild(r)}const g=()=>{if(o.replaceChildren(),p.selectedIndex>=0){const e=i.database[p.selectedIndex];((e,t="base64")=>{const s=n.PuzzleIO.import(l,e,t);console.log("Puzzle has been successfully imported.");const i=l.filter(((e,t)=>s.has(e))),o=i.EG.columns.get("rc"),a=Set.union(...i.VE.columns.filter(((e,t)=>o.has(e)&&1==t.size)).values());h.snapshot.vertices=s,h.snapshot.clues=a,h.snapshot.determined=a,h.snapshot.pencilmarked=new Set,c.init(new r.Memento("initial|final",{snapshot:h.snapshot,logs:["Puzzle loaded."],selected:-1})),h.render()})(e.data,e.format),o.appendChild(document.createTextNode("Puzzle loaded."))}else o.appendChild(document.createTextNode("No puzzle is selected."))};g(),null===(s=document.getElementById("prev"))||void 0===s||s.addEventListener("click",(()=>{o.replaceChildren(),c.moveBy(-1),console.log(`At time: ${c.time}`)})),null===(a=document.getElementById("next"))||void 0===a||a.addEventListener("click",(()=>{if(o.replaceChildren(),c.atEnd()){const e=h.snapshot.vertices,t=l.filter(((t,s)=>e.has(t)));for(const e of m){const s=e.call(h,t);if(0!=s.length){c.addSegment(s);break}}}c.moveBy(1),console.log(`At time: ${c.time}`)})),null===(d=document.getElementById("export"))||void 0===d||d.addEventListener("click",(()=>{o.replaceChildren(),o.appendChild(document.createTextNode(`base64: ${n.PuzzleIO.export(l,c.now().snapshot.vertices)}`)),navigator.clipboard.writeText(`data:image/svg+xml;base64,${btoa(h.canvas.element.outerHTML)}`)})),p.addEventListener("change",g),null===(u=document.getElementById("import"))||void 0===u||u.addEventListener("click",g),null===(f=document.getElementById("apply_cmd"))||void 0===f||f.addEventListener("click",(()=>{var e,t;const s=document.getElementById("cmd"),r=s.value;null===(t=null===(e=c.now())||void 0===e?void 0:e.snapshot.annotations)||void 0===t||t.push(r),h.load(c.now()),s.value=""}))}(d||(d={}))})()})();