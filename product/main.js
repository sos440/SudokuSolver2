(()=>{"use strict";var e={968:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uint8_to_b64=t.b64_to_uint8=void 0;const s=[...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>65+t))),...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>97+t))),...String.fromCharCode(...new Array(10).fill(0).map(((e,t)=>48+t))),"+","/"],i=new Map(s.map(((e,t)=>[e,t])));i.set("=",0);const r=/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/;t.uint8_to_b64=e=>{var t,i;const r=Math.ceil(e.length/3),o=new Array(4*r);for(let n=0;n<r;n++){const r=e.subarray(3*n,3*(n+1)),a=r[0],l=null!==(t=r[1])&&void 0!==t?t:0,d=null!==(i=r[2])&&void 0!==i?i:0;o[4*n]=s[a>>2],o[4*n+1]=s[(3&a)<<4|l>>4],o[4*n+2]=s[(15&l)<<2|d>>6],o[4*n+3]=s[63&d]}return e.length%3==1&&(o[o.length-1]="=",o[o.length-2]="="),e.length%3==2&&(o[o.length-1]="="),o.join("")},t.b64_to_uint8=e=>{var t;if(!e.match(r))throw TypeError("The input does not match the base64 format.");const s=Math.trunc(e.length/4),o=(null!==(t=e.match(/={1,2}$/))&&void 0!==t?t:[])[0].length,n=new Uint8Array(3*s-o);for(let t=0;t<s;t++){const s=[...e.substring(4*t,4*(t+1))],[r,o,a,l]=s.map((e=>{var t;return null!==(t=i.get(e))&&void 0!==t?t:0}));n[3*t]=r<<2|o>>4,n[3*t+1]=(15&o)<<4|a>>2,n[3*t+2]=(3&a)<<6|l}return n}},924:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SOGameIO=void 0;const r=s(968);class o{static import(e,t,s="base64"){if(e.D1>o.exportSymbols.length)throw RangeError("The dimensional parameter 'D1' is too large.");if(t.length==e.D2?s="simple":"data:"==t.substring(0,5)&&(s="base64"),"simple"==s){const s=[];for(const[i,r]of Array.from(t).entries()){const t=i*e.D1;if(this.importSymbols.has(r))s.push(t+this.importSymbols.get(r));else for(const i of new Array(e.D1).keys())s.push(t+i)}return new Set(s)}if("base64"==s){const s=(0,r.b64_to_uint8)(t.substring(5)),i=[];for(const[t,r]of s.entries()){let s=8*t;for(let t=0;t<8&&!(s>=e.D3);t++)(r&1<<t)>0&&i.push(s),s++}return new Set(i)}throw TypeError(`'${s}' is not a valid format.`)}static export(e,t,s="base64"){if(e.D1>o.exportSymbols.length)throw RangeError("The dimensional parameter 'D1' is too large.");if("simple"==s){const s=new Array(e.D2).fill("!");for(const i of t){const t=Math.trunc(i/e.D1),r=i%e.D1;"!"==s[t]?s[t]=this.exportSymbols[r]:s[t]="."}return s.join("")}if("base64"==s){const s=new Uint8Array(Math.ceil(e.D3/8));for(const e of s.keys()){let i=0;for(let s=0;s<8;s++)t.has(8*e+s)&&(i|=1<<s);s[e]=i}return`data:${(0,r.uint8_to_b64)(s)}`}throw TypeError(`'${s}' is not a valid format.`)}}t.SOGameIO=o,i=o,o.exportSymbols=["1","2","3","4","5","6","7","8","9",...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>65+t))),...String.fromCharCode(...new Array(26).fill(0).map(((e,t)=>97+t))),"<",">"],o.importSymbols=new Map(i.exportSymbols.map(((e,t)=>[e,t])))},660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergiter=t.multirange=t.range=t.Range=t.BaseN=void 0;class s{constructor(e){this.base=e}static fromD(e,t){return e.reduce(((e,s)=>e*t+s),0)}fromDigits(e){return s.fromD(e,this.base)}static toD(e,t,s){const i=Array.from({length:t});for(let r=t-1;r>0;r--)i[r]=e%s,e=Math.trunc(e/s);return i[0]=e,i}toDigits(e,t){return s.toD(e,t,this.base)}}t.BaseN=s;class i{constructor(e,t){if(void 0===t){if(!Number.isInteger(e))throw TypeError("The inputs must be integer.");this.a=0,this.b=e}else{if(!Number.isInteger(e)||!Number.isInteger(t))throw TypeError("The inputs must be integer.");this.a=e,this.b=t}}at(e){return this.a+e}get length(){return this.b-this.a}set length(e){this.b=this.a+e}*keys(){const e=this.b-this.a;for(let t=0;t<e;t++)yield t}*values(){for(let e=this.a;e<this.b;e++)yield e}*[Symbol.iterator](){for(let e=this.a;e<this.b;e++)yield e}*entries(){const e=this.b-this.a;for(let t=0;t<e;t++)yield[t,this.a+t]}map(e){const t=this.b-this.a,s=new Array(t);for(let i=0;i<t;i++)s[i]=e(this.a+i,i);return s}forEach(e){const t=this.b-this.a;new Array(t);for(let s=0;s<t;s++)e(this.a+s,s)}}function*r(e,t=[]){if(0==e.length)return[];const s="number"==typeof e[0]?0:e[0][0],i="number"==typeof e[0]?e[0]:e[0][1];if(1==e.length)for(let e=s;e<i;e++)yield[...t,e];else for(let o=s;o<i;o++)yield*r(e.slice(1),[...t,o])}t.Range=i,t.range=(e,t)=>new i(e,t),t.multirange=(...e)=>r(e),t.mergiter=(...e)=>function*(e,s=[]){if(0!=e.length)if(1==e.length)for(const t of e[0])yield[...s,t];else for(const i of e[0])yield*(0,t.mergiter)(e.slice(1),[...s,i]);else yield[]}(e)},997:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.database=void 0,t.database=[{format:"simple",data:"956700000400800000300910700021000000000000300790000120000029003000008004000007650",desc:"Diabolic grade from SudokuWiki."},{format:"simple",data:"300750001000300020000009407020001005700000006500900070905100000070003000100068002",desc:"Devious grade from Sudoku+."},{format:"simple",data:"..3.5...7.96..85.....3.2...3....7.6...2...9...8.2....5...9.4.....18..63.4...1.8..",desc:"Devious grade from Sudoku+."},{format:"simple",data:"000008040009040000006203008042009003005000800800400970200307500000090300030800000",desc:"Devious grade from Sudoku+."},{format:"simple",data:"070008029002000004854020000008374200000000000003261700000090612200000400130600070",desc:"Naked triple example 1 from SudokuWiki."},{format:"simple",data:"200010000600800009300607054000056000040080060000470000730104005900005001000020007",desc:"Naked triple example 2 from SudokuWiki."},{format:"simple",data:"000004000000170600480356100004007500000010700500020034950000006120000008000000000",desc:"naked triple exampe 3 from Hodoku."},{format:"simple",data:"000030086000020000000008500371000094900000005400007600200700800030005000700004030",desc:"Naked quad example 1 from SudokuWiki."},{format:"simple",data:"000000060000030047032500000600007005207010908081004000000002000000000001005870000",desc:"Naked quad example 2 from Hodoku."},{format:"simple",data:"009032000000700000162000000010020560000900000050000107000000403026009000005870000",desc:"Hidden pair 1 example."},{format:"simple",data:"500010003006003002003200000002300076000050000190007500000009400200800600900040005",desc:"Swordfish example 1 from SudokuWiki."}]},501:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(Map,"merge",{value:function e(t,s){const i=new Map(t);for(const[e,s]of t.entries())i.set(e,s);for(const[t,r]of s.entries())if(i.has(t)){const s=i.get(t);r instanceof Set&&s instanceof Set?i.set(t,Set.union(s,r)):r instanceof Map&&s instanceof Map?i.set(t,e(s,r)):i.set(t,r)}else i.set(t,r);return i},enumerable:!1}),Object.defineProperty(Map.prototype,"filter",{value:function(e){const t=new Map;for(const[s,i]of this)e(s,i,this)&&t.set(s,i);return t},enumerable:!1}),Object.defineProperty(Map.prototype,"map",{value:function(e){const t=new Map;for(const[s,i]of this)t.set(s,e(s,i,this));return t},enumerable:!1}),Object.defineProperty(Map.prototype,"clearEmptyKeys",{value:function(){const e=new Map;for(const[t,s]of this)void 0!==s&&(s instanceof Set&&0==s.size||s instanceof Map&&0==s.size||e.set(t,s));return e},enumerable:!1})},361:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,r)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),r=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(s(570),t),r(s(501),t),r(s(351),t)},351:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MSet=void 0;class s extends Map{constructor(e){if(super(),e instanceof s)for(const[t,s]of e)this.set(t,s);else if(e)for(const t of e)this.add(t)}get count(){return Array.from(this.values()).reduce(((e,t)=>e+t),0)}aget(e){var t;return null!==(t=this.get(e))&&void 0!==t?t:0}modify(e,t){var s;const i=(null!==(s=this.get(e))&&void 0!==s?s:0)+t;return 0==i?this.delete(e):this.set(e,i),this}add(e){return this.modify(e,1)}remove(e){return this.modify(e,-1)}elements(){return this.keys()}every(e){for(const[t,s]of this)if(!e(t,s,this))return!1;return!0}some(e){for(const[t,s]of this)if(e(t,s,this))return!0;return!1}static geqZero(e){for(const[t,s]of e)if(s<0)return!1;return!0}static geq(e,t){var s,i;for(const[i,r]of e)if(r<(null!==(s=t.get(i))&&void 0!==s?s:0))return!1;for(const[s,r]of t)if(r>(null!==(i=e.get(s))&&void 0!==i?i:0))return!1;return!0}static add(...e){var t;const i=new s;for(const s of e)for(const[e,r]of s)i.set(e,(null!==(t=i.get(e))&&void 0!==t?t:0)+r);for(const[e,t]of i)0==t&&i.delete(e);return i}static subtract(e,t){var i;const r=new s;for(const[t,s]of e)r.set(t,s);for(const[e,s]of t)r.set(e,(null!==(i=r.get(e))&&void 0!==i?i:0)-s);for(const[e,t]of r)0==t&&r.delete(e);return r}pick(e){for(const e of this.keys())return e;return e}}t.MSet=s},570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=function(...e){if(0==e.length)return new Set;if(1==e.length)return new Set(e[0]);if(2==e.length){const[t,s]=e[0].size>e[1].size?e:e.reverse(),i=new Set(t);for(const e of s)i.add(e);return i}return s(s(...e.slice(0,2)),...e.slice(2))},i=function(...e){if(0==e.length)throw RangeError("Set intersection requires at least one set.");if(1==e.length)return new Set(e[0]);if(2==e.length){const[t,s]=e[0].size<e[1].size?e:e.reverse(),i=new Set(t);for(const e of t)s.has(e)||i.delete(e);return i}return i(i(...e.slice(0,2)),...e.slice(2))};Object.defineProperty(Set,"union",{value:s,enumerable:!1}),Object.defineProperty(Set,"intersection",{value:i,enumerable:!1}),Object.defineProperty(Set,"diff",{value:function(e,t){const s=new Set(e);for(const e of t)s.delete(e);return s},enumerable:!1}),Object.defineProperty(Set.prototype,"filter",{value:function(e){const t=new Set;for(const s of this)e(s,this)&&t.add(s);return t},enumerable:!1}),Object.defineProperty(Set.prototype,"map",{value:function(e){const t=new Set;for(const s of this)t.add(e(s,this));return t},enumerable:!1}),Object.defineProperty(Set.prototype,"subsets",{value:function*(e,t,s){if(!(e>this.size||e<0))if(0!=e)if(e!=this.size){s=null!=s?s:[...this.values()];for(let i=0;i<s.length;i++){const r=new Set(t).add(s[i]);1==e?yield r:yield*this.subsets(e-1,r,s.slice(i+1))}}else yield new Set(this);else yield new Set},enumerable:!1}),Object.defineProperty(Set.prototype,"every",{value:function(e){for(const t of this)if(!e(t,this))return!1;return!0},enumerable:!1}),Object.defineProperty(Set.prototype,"some",{value:function(e){for(const t of this)if(e(t,this))return!0;return!1},enumerable:!1})},316:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SOPuzzle=void 0,s(361);const i=s(660);t.SOPuzzle=class{constructor(e,t){if(this.isDimParam=e=>Number.isInteger(e)&&e>0&&e<=8,this.isVertexID=e=>Number.isInteger(e)&&e>=0&&e<this.D3,this.isVertexIDSet=e=>!!e&&e.every(this.isVertexID),!this.isDimParam(e))throw RangeError(`'${e}' is not a valid dimensional parameter.`);this.type="sudoku original",this.p=e,this.D1=Math.pow(this.p,2),this.D2=Math.pow(this.D1,2),this.D3=Math.pow(this.D1,3),this.adV=[],this.adE={rc:[],rk:[],ck:[],bk:[]},this.adF={row:[],col:[],box:[],key:[]};for(const[e,t,s]of this.loopRawFaces())this.adF[t][s]={type:t,id:s,$:{v:new Set,rc:new Set,rk:new Set,ck:new Set,bk:new Set}};for(const[e,t,s,r,o]of this.loopRawEdges()){const[e,n]=i.BaseN.toD(s,2,this.D1),a={type:t,id:s,proj:this.adF[r][e],$:{v:new Set,[r]:this.adF[r][e],[o]:this.adF[o][n],rc:new Set,rk:new Set,ck:new Set,bk:new Set}};"rc"==t&&(a.proj=a),this.adE[t][s]=a}t=null!=t?t:new Set((0,i.range)(this.D3));for(const e of t){if(!this.isVertexID(e))throw RangeError(`'${e}' is not a valid vertex ID.`);const[t,s,r]=i.BaseN.toD(e,3,this.D1),o=i.BaseN.toD(e,6,this.p),n=i.BaseN.fromD([o[0],o[2]],this.p),a=(i.BaseN.fromD([o[1],o[3]],this.p),{id:e,$:{rc:this.adE.rc[i.BaseN.fromD([t,s],this.D1)],rk:this.adE.rk[i.BaseN.fromD([t,r],this.D1)],ck:this.adE.ck[i.BaseN.fromD([s,r],this.D1)],bk:this.adE.bk[i.BaseN.fromD([n,r],this.D1)],row:this.adF.row[t],col:this.adF.col[s],box:this.adF.box[n],key:this.adF.key[r]}});this.adV[e]=a;for(const e of this.edgeTypes()){a.$[e].$.v.add(a);for(const t of this.edgeTypes())a.$[e].$[t].add(a.$[t])}for(const e of this.faceTypes()){a.$[e].$.v.add(a);for(const t of this.edgeTypes())a.$[e].$[t].add(a.$[t])}}}*edgeTypes(){yield*["rc","rk","ck","bk"]}*edgeTypeTriples(){yield*[["rc","row","col"],["rk","row","key"],["ck","col","key"],["bk","box","key"]]}*faceTypes(){yield*["row","col","box","key"]}*loopRawEdges(){for(const[e,t,s]of this.edgeTypeTriples())for(const r of(0,i.range)(this.D2))yield[this.adE[e][r],e,r,t,s]}*loopRawFaces(){for(const e of this.faceTypes())for(const t of(0,i.range)(this.D1))yield[this.adF[e][t],e,t]}*loopEdges(e,t){if(t&&!this.isVertexIDSet(t))throw RangeError("The input is not a valid set of vertex IDs.");for(const s of e)t?yield*t.map((e=>this.adV[e].$[s])):yield*this.adE[s]}*loopLineBox(){for(const e of["rk","ck"])for(const t of this.adE[e])for(const e of t.$.bk)yield[t,e]}*loopFaceConfig(e,t){for(const[s,i,r]of t)for(const t of this.adF[s]){const s=t.$[i].filter((e=>e.$.v.size>1));for(const i of s.subsets(e)){const s=Set.union(...i.map((e=>e.$.v))),o=s.map((e=>e.$[r]));if(o.size>e)continue;const n=Set.union(...o.map((e=>e.$.v))),a=Set.diff(n,s);0!=a.size&&(yield{face:t,strongEdges:i,strongVertices:s,weakEdges:o,weakVertices:n,weakOnlyVertices:a})}}}}},424:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SOSolver=void 0,s(361);const i=s(787),r=s(316),o=s(554);class n extends i.Originator{constructor(e,t){super(),this.game=e,this.canvas=new o.PuzzleCanvas(t),this.snapshot={vertices:new Set,clues:new Set,determined:new Set,pencilmarked:new Set,annotations:[]},this.selected=-1}load(e){this.snapshot=e.snapshot,this.selected=e.selected;for(const t of e.logs)console.log(t);this.render()}render(){var e,t,s,i,o,n;const a=this.snapshot.vertices,l=this.snapshot.clues,d=this.snapshot.determined,h=this.snapshot.pencilmarked,c=this.snapshot.annotations,u=new r.SOPuzzle(this.game.p,a),p=this.canvas,f=p.style;p.cellRects.clearAll(),p.cellTexts.hideAll().clearAll(),p.markRects.hideAll().clearAll(),p.markTexts.hideAll().clearAll(),p.drawing.html("");for(const e of u.loopEdges(["rc"])){const t=e.$.v;1==t.size?t.forEach((t=>{l.has(t.id)?p.cellTexts.show(e.id).html(`${f["mark-symbols"].charAt(t.id%9)}`).attr({fill:"blue"}):d.has(t.id)?p.cellTexts.show(e.id).html(`${f["mark-symbols"].charAt(t.id%9)}`):p.markTexts.show(t.id)})):0==t.size?p.cellTexts.show(e.id).html("X").attr({fill:"red"}):h.has(e.id)&&t.forEach((e=>{p.markTexts.show(e.id)}))}for(const r of c){const a=r.match(/^highlight (\S+) ([\d\s,]+) as (.*)$/);if(a){const r=a[1],l=a[2].split(/[\s,]+/).map((e=>Number.parseInt(e))),d=a[3];for(const a of l)if("mark"==r){if(null===(e=p.markRects.show(a))||void 0===e||e.attr(f[`rect:${d}`]),null===(t=p.markTexts.get(a))||void 0===t||t.attr(f[`text:${d}`]),"removed"==d){const e=p.markRects.get(a).element,t=e.getAttribute("x"),s=e.getAttribute("y"),i=e.getAttribute("width"),r=e.getAttribute("height");p.drawing.path({d:`M ${t} ${s} l ${i} ${r} m -${i} 0 l ${i} -${r}`}).attr({stroke:"red"})}}else if("cell"==r||"rc"==r)null===(s=p.cellRects.show(a))||void 0===s||s.attr(f[`rect:${d}`]),null===(i=p.cellTexts.get(a))||void 0===i||i.attr(f[`text:${d}`]);else if("row"==r||"col"==r||"box"==r)for(const e of u.adF[r][a].$.rc)null===(o=p.cellRects.show(e.id))||void 0===o||o.attr(f[`rect:${d}`]),null===(n=p.cellTexts.get(e.id))||void 0===n||n.attr(f[`text:${d}`])}}}obviousCandidateRemoval(e){let t=!1;const s=new Set(this.snapshot.vertices),i=this.snapshot.determined,r=new Array,o=[{type:"initial",logs:["updated by obvious candidate removal"],snapshot:{pencilmarked:new Set(e.adE.rc.keys()),annotations:r}},{type:"final",logs:[],snapshot:{vertices:s,annotations:[]}}];for(const o of i){const i=e.adV[o],n=Set.union(i.$.rk.$.v,i.$.ck.$.v,i.$.bk.$.v);n.delete(i);for(const e of n)t=!0,s.delete(e.id),r.push(`highlight mark ${e.id} as removed`)}return t?o:[]}nakedSingle(e){let t=!1;const s=new Set(this.snapshot.determined),i=new Array,r=[{type:"initial",logs:["updated by naked single"],snapshot:{determined:s,annotations:i}},{type:"final",logs:[],snapshot:{annotations:[]}}];for(const r of e.adE.rc){const e=r.$.v,o=[...e][0];1!=e.size||s.has(o.id)||(t=!0,s.add(o.id),i.push(`highlight cell ${o.$.rc.id} as determined`))}return t?r:[]}hiddenSingle(e){var t,s;const i=new Set(this.snapshot.vertices),r=new Set(this.snapshot.determined),o=new Array,n=new Array,a=[{type:"initial",logs:["updated by hidden single"],snapshot:{annotations:o}},{type:"middle",logs:[],snapshot:{vertices:i,determined:r,annotations:n}},{type:"final",logs:[],snapshot:{annotations:[]}}];for(const l of e.loopEdges(["rk","ck","bk"])){const e=l.proj,d=l.$.v;if(d.size>1)continue;const h=[...d][0];if(r.has(h.id))continue;const c=h.$.rc,u=new Set(c.$.v);if(u.delete(h),0!=u.size){null===(t=a[0].logs)||void 0===t||t.push(`log "Vertex ${h.id} is a hidden single in ${e.type} ${e.id+1}."`),o.push(`highlight mark ${h.id} as determined`),o.push(`highlight ${e.type} ${e.id} as based`),o.push(`highlight cell ${c.id} as intersect`);for(const e of u)i.delete(e.id),null===(s=a[1].logs)||void 0===s||s.push(`log "Vertex ${e.id} is in the same unit as the hidden single, hence is removed."`),o.push(`highlight mark ${e.id} as removed`);return r.add(h.id),n.push(`highlight cell ${c.id} as determined`),a}}return[]}intersectionPointing(e){var t,s;const i=new Set(this.snapshot.vertices),r=new Array,o=[{type:"initial",logs:["updated by intersection (pointing)"],snapshot:{annotations:r}},{type:"final",logs:[],snapshot:{vertices:i,annotations:[]}}];for(const[n,a]of e.loopLineBox()){const e=a.$.v,l=n.$.v,d=Set.intersection(e,l);if(e.size==d.size&&l.size>d.size){null===(t=o[0].logs)||void 0===t||t.push(`log "The box ${a.proj.id+1} and ${n.proj.type} ${n.proj.id+1} are locked."`),r.push(`highlight mark ${[...d.map((e=>e.id))]} as determined`),r.push(`highlight ${n.proj.type} ${n.proj.id} as affected`),r.push(`highlight box ${a.proj.id} as based`),r.push(`highlight cell ${[...Set.intersection(n.$.rc,a.$.rc).map((e=>e.id))]} as intersect`);for(const e of Set.diff(l,d))i.delete(e.id),null===(s=o[1].logs)||void 0===s||s.push(`log "Vertex ${e.id} in ${n.proj.type} ${a.proj.id+1} is erased by the pointer."`),r.push(`highlight mark ${e.id} as removed`);return o}}return[]}intersectionClaiming(e){var t,s;const i=new Set(this.snapshot.vertices),r=new Array,o=[{type:"initial",logs:["updated by intersection (pointing)"],snapshot:{annotations:r}},{type:"final",logs:[],snapshot:{vertices:i,annotations:[]}}];for(const[n,a]of e.loopLineBox()){const e=a.$.v,l=n.$.v,d=Set.intersection(e,l);if(l.size==d.size&&e.size>d.size){null===(t=o[0].logs)||void 0===t||t.push(`log "The box ${a.proj.id+1} and ${n.proj.type} ${n.proj.id+1} are locked."`),r.push(`highlight mark ${[...d.map((e=>e.id))]} as determined`),r.push(`highlight box ${a.proj.id} as affected`),r.push(`highlight ${n.proj.type} ${n.proj.id} as based`),r.push(`highlight cell ${[...Set.intersection(n.$.rc,a.$.rc).map((e=>e.id))]} as intersect`);for(const t of Set.diff(e,d))i.delete(t.id),null===(s=o[1].logs)||void 0===s||s.push(`log "Vertex ${t.id} in box ${a.proj.id+1} is erased by the claimer."`),r.push(`highlight mark ${t.id} as removed`);return o}}return[]}nakedSubsetGenerator(e){if(!Number.isInteger(e)||e<2||e>4)throw RangeError("Invalid range of parameter.");const t={2:"pair",3:"triple",4:"quad"}[e];return s=>{var i,r;const o=new Set(this.snapshot.vertices),n=new Array,a=[{type:"initial",logs:[`updated by naked ${t}`],snapshot:{annotations:n}},{type:"final",logs:[],snapshot:{vertices:o,annotations:[]}}];for(const l of s.loopFaceConfig(e,[["row","rc","rk"],["col","rc","ck"],["box","rc","bk"]])){const e=l.face,s=l.strongEdges,d=l.strongVertices,h=l.weakOnlyVertices;null===(i=a[0].logs)||void 0===i||i.push(`log "Cells ${[...s.map((e=>e.id))]} form a naked ${t} in ${e.type} ${e.id+1}."`),n.push(`highlight mark ${[...d.map((e=>e.id))]} as determined`),n.push(`highlight ${e.type} ${e.id} as affected`),n.push(`highlight cell ${[...s.map((e=>e.id))]} as intersect`);for(const e of h)o.delete(e.id),null===(r=a[1].logs)||void 0===r||r.push(`log "Vertex ${e.id} is erased."`),n.push(`highlight mark ${e.id} as removed`);return a}return[]}}hiddenSubsetGenerator(e){if(!Number.isInteger(e)||e<2||e>4)throw RangeError("Invalid range of parameter.");const t={2:"pair",3:"triple",4:"quad"}[e];return s=>{var i,r;const o=new Set(this.snapshot.vertices),n=new Array,a=[{type:"initial",logs:[`updated by hidden ${t}`],snapshot:{annotations:n}},{type:"final",logs:[],snapshot:{vertices:o,annotations:[]}}];for(const l of s.loopFaceConfig(e,[["row","rk","rc"],["col","ck","rc"],["box","bk","rc"]])){const e=l.face,s=l.strongVertices,d=l.weakEdges,h=l.weakOnlyVertices;null===(i=a[0].logs)||void 0===i||i.push(`log "Cells ${[...d.map((e=>e.id))]} form a hidden ${t} in ${e.type} ${e.id+1}."`),n.push(`highlight mark ${[...s.map((e=>e.id))]} as determined`),n.push(`highlight ${e.type} ${e.id} as based`),n.push(`highlight cell ${[...d.map((e=>e.id))]} as intersect`);for(const e of h)o.delete(e.id),null===(r=a[1].logs)||void 0===r||r.push(`log "Vertex ${e.id} is erased."`),n.push(`highlight mark ${e.id} as removed`);return a}return[]}}fishGenerator(e){if(!Number.isInteger(e)||e<2||e>4)throw RangeError("Invalid range of parameter.");const t={2:"X-wing",3:"swordfish",4:"jellyfish"}[e];return s=>{var i,r;const o=new Set(this.snapshot.vertices),n=new Array,a=[{type:"initial",logs:[`updated by ${t}`],snapshot:{annotations:n}},{type:"final",logs:[],snapshot:{vertices:o,annotations:[]}}];for(const l of s.loopFaceConfig(e,[["key","rk","ck"],["key","ck","rk"]])){const e=l.face,s=l.strongEdges,d=l.strongVertices,h=l.weakEdges,c=l.weakOnlyVertices;null===(i=a[0].logs)||void 0===i||i.push(`log "Candidates ${e.id+1} of cells ${[...d.map((e=>e.$.rc.id))]} form a ${t}."`),n.push(`highlight mark ${[...d.map((e=>e.id))]} as determined`),s.forEach((e=>{n.push(`highlight ${e.proj.type} ${e.proj.id} as based`)})),h.forEach((e=>{n.push(`highlight ${e.proj.type} ${e.proj.id} as affected`)})),n.push(`highlight cell ${[...d.map((e=>e.$.rc.id))]} as intersect`);for(const e of c)o.delete(e.id),null===(r=a[1].logs)||void 0===r||r.push(`log "Vertex ${e.id} is erased."`),n.push(`highlight mark ${e.id} as removed`);return a}return[]}}}t.SOSolver=n},554:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PuzzleCanvas=t.SVG=void 0,s(361);const i=s(660);class r{constructor(e,t){return this.element=document.createElementNS("http://www.w3.org/2000/svg",e),"svg"==e&&this.attr({xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),this.attr(t)}html(e){return this.element.innerHTML=e,this}attr(e={}){for(const t in e)void 0===e[t]||null==e[t]?this.element.removeAttribute(t):this.element.setAttribute(t,e[t]);return this}addTo(e){return e instanceof r&&(e=e.element),e.contains(this.element)||e.appendChild(this.element),this}remove(e){return e instanceof r&&(e=e.element),this.element.contains(e)&&this.element.removeChild(e),this}use(e,t){return new r("use").attr({href:e}).attr(t).addTo(this.element)}g(e){return new r("g").attr(e).addTo(this.element)}defs(e){return new r("defs").attr(e).addTo(this.element)}symbol(e){return new r("symbol").attr(e).addTo(this.element)}rect(e){return new r("rect").attr(e).addTo(this.element)}circle(e){return new r("circle").attr(e).addTo(this.element)}ellipse(e){return new r("ellipse").attr(e).addTo(this.element)}line(e){return new r("line").attr(e).addTo(this.element)}polygon(e){return new r("polygon").attr(e).addTo(this.element)}polyline(e){return new r("polyline").attr(e).addTo(this.element)}path(e){return new r("path").attr(e).addTo(this.element)}text(e,t){return new r("text").html(e).attr(t).addTo(this.element)}}t.SVG=r;class o{constructor(e){this.group=e,this.elements=new Map}get(e){return this.elements.get(e)}set(e,t){this.elements.set(e,t)}show(e){if(this.elements.has(e))return this.elements.get(e).addTo(this.group)}hide(e){if(!this.elements.has(e))return;const t=this.elements.get(e);return this.group.remove(t.element),t}showAll(){return this.elements.map(((e,t)=>t.addTo(this.group))),this}hideAll(){return this.elements.map(((e,t)=>this.group.remove(t))),this}clearStyle(e){const t=e instanceof r?e:this.elements.get(e),s=["fill","stroke","stroke-width"];if(void 0!==t){for(const e of s)t.element.removeAttribute(e);return t}}clearAll(){return this.elements.map(((e,t)=>this.clearStyle(t))),this}}class n extends r{constructor(e={}){super("svg");const t=n.computeStyle(e);this.attr({width:t["canvas-width"],height:t["canvas-height"],viewBox:`0 0 ${t["canvas-width"]} ${t["canvas-height"]}`,"text-anchor":"middle","dominant-baseline":"middle"});const s=t.rows,a=t.columns,l=t.dimension,d=Math.pow(l,2);if(this.rect({id:"bg",width:t["canvas-width"],height:t["canvas-height"]}).attr(t.background),this.headerGroup=this.g({id:"header"}).attr(t["header-font"]),"display"==t.headers){const e=.5*(t["header-size"]+t["grid-padding"]);for(const i of new Array(s).keys()){const s=n.cellCenterXY(0,i,t);this.headerGroup.text(t["header-row-symbols"].charAt(i),{x:e,y:s[1]})}for(const s of new Array(a).keys()){const i=n.cellCenterXY(s,0,t);this.headerGroup.text(t["header-column-symbols"].charAt(s),{x:i[0],y:e})}}const h=t["cell-size"];this.cellRects=new o(this.g({id:"cell_rect",fill:"white"})),this.cellTexts=new o(this.g({id:"cell_text"}).attr(t["cell-font"]));for(const[e,o]of(0,i.multirange)(s,a)){const s=o*a+e,i=n.cellXY(e,o,t);this.cellRects.set(s,new r("rect",{x:i[0],y:i[1],width:h,height:h,rx:4,ry:4})),this.cellTexts.set(s,new r("text",{x:i[0]+.5*h,y:i[1]+.5*h}))}const c=t["mark-size"];this.markRects=new o(this.g({id:"mark_rect"})),this.markTexts=new o(this.g({id:"mark_text"}).attr(t["mark-font"]));for(const[e,o,l]of(0,i.multirange)(a,s,d)){const s=(o*a+e)*d+l,i=n.markXY(e,o,l,t);this.markRects.set(s,new r("rect",{x:i[0],y:i[1],width:c,height:c,rx:4,ry:4})),this.markTexts.set(s,new r("text").html(t["mark-symbols"].charAt(l)).attr({x:i[0]+.5*c,y:i[1]+.5*c}))}this.drawing=this.g({id:"drawing"}),this.cellRects.showAll(),this.style=t}static computeStyle(e={}){if((e=Object.assign(Object.assign({},n.options),e)).rows!=e["header-row-symbols"].length)throw RangeError("The length of the row header does not match the number of rows.");if(e.columns!=e["header-column-symbols"].length)throw RangeError("The length of the column header does not match the number of columns.");if(Math.pow(e.dimension,2)!=e["mark-symbols"].length)throw RangeError("The length of the column header does not match the number of columns.");const t=e.dimension;e["cell-size"]=t*e["mark-size"]+(t-1)*e["cell-inner-sep"]+2*e["cell-padding"],e["box-size"]=t*e["cell-size"]+(t-1)*e["box-inner-sep"]+2*e["box-padding"];const s=[e.columns,e.rows],i=s.map((e=>Math.ceil(e/t))),r=s.map(((t,r)=>s[r]*e["cell-size"]+(s[r]-i[r])*e["box-inner-sep"]+2*i[r]*e["box-padding"]+(i[r]-1)*e["grid-inner-sep"]+2*e["grid-padding"]));return e["grid-width"]=r[0],e["grid-height"]=r[1],e["canvas-width"]=e["grid-width"]+("display"==e.headers?e["header-size"]:0),e["canvas-height"]=e["grid-height"]+("display"==e.headers?e["header-size"]:0),e}static cellXY(e,t,s){if(!("cell-size"in s))throw TypeError("The property 'cell-size' has not been computed yet.");const i=s.dimension,r=[e,t],o=r.map((e=>Math.trunc(e/i)));return r.map(((e,t)=>("display"==s.headers?s["header-size"]:0)+o[t]*s["grid-inner-sep"]+s["grid-padding"]+(r[t]-o[t])*s["box-inner-sep"]+(2*o[t]+1)*s["box-padding"]+r[t]*s["cell-size"]))}static cellCenterXY(e,t,s){if(!("cell-size"in s))throw TypeError("The property 'cell-size' has not been computed yet.");return n.cellXY(e,t,s).map((e=>e+.5*s["cell-size"]))}static markXY(e,t,s,i){if(!("cell-size"in i))throw TypeError("The property 'cell-size' has not been computed yet.");const r=i.dimension,o=[e,t],a=n.cellXY(e,t,i),l=[s%r,Math.trunc(s/r)];return o.map(((e,t)=>a[t]+l[t]*(i["cell-inner-sep"]+i["mark-size"])+i["cell-inner-sep"]))}static markCenterXY(e,t,s,i){return n.markXY(e,t,s,i).map((e=>e+.5*i["mark-size"]))}}t.PuzzleCanvas=n,n.options={rows:9,columns:9,dimension:3,"mark-size":14,"mark-symbols":"123456789","cell-inner-sep":1,"cell-padding":1,"box-inner-sep":1,"box-padding":0,"grid-inner-sep":3,"grid-padding":4,headers:"display","header-size":12,"header-row-symbols":"ABCDEFGHJ","header-column-symbols":"123456789",background:{fill:"black",rx:4,ry:4},"header-font":{"font-family":"Helvetica","font-size":10,fill:"white"},"mark-font":{"font-family":"Helvetica","font-size":9,fill:"black"},"cell-font":{"font-family":"Helvetica","font-size":30,fill:"black"},"rect:removed":{fill:"yellow",stroke:"pink","stroke-width":.75},"rect:determined":{fill:"#6fff83",stroke:"olive","stroke-width":.75},"rect:based":{fill:"#00CED1",stroke:"#2F4F4F","stroke-width":.75},"rect:intersect":{fill:"#73b2ff",stroke:"blue","stroke-width":.75},"rect:affected":{fill:"pink",stroke:"red","stroke-width":.75},"text:removed":{fill:"red"},"text:determined":{fill:"blue"},"text:intersect":{},"text:based":{},"text:affected":{}}},787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Caretaker=t.Memento=t.Originator=void 0,t.Originator=class{};class s{constructor(e="undefined",t){this.type="undefined",this.type=e,this.snapshot={},this.logs=[],this.selected=NaN,void 0!==t&&this.copyFrom(t)}isInitial(){return null!=this.type.match(/initial/)}isFinal(){return null!=this.type.match(/final/)}copyFrom(e){var t,s,i;return this.type=null!==(t=e.type)&&void 0!==t?t:this.type,this.logs=null!==(s=e.logs)&&void 0!==s?s:this.logs,this.selected=e.selected&&NaN!=e.selected?e.selected:this.selected,Object.assign(this.snapshot,null!==(i=e.snapshot)&&void 0!==i?i:{}),this}}t.Memento=s,t.Caretaker=class{constructor(e){this.history=new Array,this.time=-1,this.originator=e}atEnd(){return this.time==this.history.length-1}now(){var e;return null!==(e=this.history[this.time])&&void 0!==e?e:null}last(){var e;return null!==(e=this.history[this.history.length-1])&&void 0!==e?e:null}getLastFinalTime(e){for(let t=e;t>=0;t--)if(this.history[t].isFinal())return t;return-1}init(e){this.history=[],this.history.push(e),this.time=0}addSegment(e){const t=this.getLastFinalTime(this.time);if(-1==t)throw RangeError("Something is wrong; there are no final events up to the specified time.");this.history=this.history.slice(0,t+1);for(const t of e)this.history.push((new s).copyFrom(this.last()).copyFrom(t))}moveTo(e){return!(e>=this.history.length||e<0||(this.time=e,this.originator.load(this.history[this.time]),0))}moveBy(e){return this.moveTo(this.time+e)}}}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}(()=>{s(361);const e=s(316),t=s(424),i=s(787),r=s(924),o=s(997);console.log("Sudoku Solver build 009");const n=document.getElementById("logs"),a=document.getElementById("puzzle"),l=new e.SOPuzzle(3),d=new t.SOSolver(l);d.canvas.addTo(a);const h=new i.Caretaker(d);var c;!function(t){var s,a,c,u,p,f;const m=[d.obviousCandidateRemoval,d.nakedSingle,d.hiddenSingle,d.intersectionPointing,d.intersectionClaiming,d.nakedSubsetGenerator(2),d.nakedSubsetGenerator(3),d.hiddenSubsetGenerator(2),d.nakedSubsetGenerator(4),d.hiddenSubsetGenerator(3),d.hiddenSubsetGenerator(4),d.fishGenerator(2),d.fishGenerator(3),d.fishGenerator(4)],g=document.getElementById("samples");for(const[e,t]of o.database.entries()){const i=document.createElement("option");i.value=e.toString(),i.innerText=null!==(s=t.desc)&&void 0!==s?s:`Sample #${e+1}`,i.selected=0==e,g.appendChild(i)}const y=()=>{if(n.replaceChildren(),g.selectedIndex>=0){const t=o.database[g.selectedIndex];((t,s="base64")=>{const o=r.SOGameIO.import(l,t,s),n=new e.SOPuzzle(l.p,o),a=Set.union(...n.adE.rc.filter((e=>1==e.$.v.size)).map((e=>e.$.v.map((e=>e.id)))));d.snapshot.vertices=o,d.snapshot.clues=a,d.snapshot.determined=a,d.snapshot.pencilmarked=new Set,d.snapshot.annotations=[],h.init(new i.Memento("initial|final",{snapshot:d.snapshot,logs:["Puzzle loaded."],selected:-1})),d.render(),console.log("Puzzle has been successfully imported.")})(t.data,t.format),n.appendChild(document.createTextNode("Puzzle loaded."))}else n.appendChild(document.createTextNode("No puzzle is selected."))};y(),null===(a=document.getElementById("prev"))||void 0===a||a.addEventListener("click",(()=>{n.replaceChildren(),h.moveBy(-1),console.log(`At time: ${h.time}`)})),null===(c=document.getElementById("next"))||void 0===c||c.addEventListener("click",(()=>{if(console.time("benchmark"),n.replaceChildren(),h.atEnd()){const t=d.snapshot.vertices,s=new e.SOPuzzle(l.p,t);for(const e of m){const t=e.call(d,s);if(0!=t.length){h.addSegment(t);break}}}h.moveBy(1),console.log(`At time: ${h.time}`),console.timeEnd("benchmark")})),null===(u=document.getElementById("export"))||void 0===u||u.addEventListener("click",(()=>{n.replaceChildren(),n.appendChild(document.createTextNode(`base64: ${r.SOGameIO.export(l,h.now().snapshot.vertices)}`)),navigator.clipboard.writeText(`data:image/svg+xml;base64,${btoa(d.canvas.element.outerHTML)}`)})),g.addEventListener("change",y),null===(p=document.getElementById("import"))||void 0===p||p.addEventListener("click",y),null===(f=document.getElementById("apply_cmd"))||void 0===f||f.addEventListener("click",(()=>{var e,t;const s=document.getElementById("cmd"),i=s.value;null===(t=null===(e=h.now())||void 0===e?void 0:e.snapshot.annotations)||void 0===t||t.push(i),d.load(h.now()),s.value=""}))}(c||(c={}))})()})();